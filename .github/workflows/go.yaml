name: Integration tests

on:
  push:
  pull_request:
    branches: [ master, develop ]

jobs:
  test:
      strategy:
        matrix:
          go-version: [ 1.20.x ]
          platform: [ ubuntu-latest ]
      runs-on: ${{ matrix.platform }}
      steps:
          - name: Install Go
            uses: actions/setup-go@v3
            with:
              go-version: ${{ matrix.go-version }}
          - name: Checkout code
            uses: actions/checkout@v2
          - name: Set GOPATH
            run: echo "$GOPATH=$(go env GOPATH)" >> $GITHUB_ENV

          - name: Run unit tests
            run: |
              source $GITHUB_ENV
              cd /src/mainstay
              ./scripts/run-tests.sh